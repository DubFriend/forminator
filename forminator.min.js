// forminator version 0.0.0
// https://github.com/DubFriend/forminator
// (MIT) 20-03-2014
// Brian Detering <BDeterin@gmail.com> (http://www.briandetering.net/)
!function(){"use strict";!function(a){var b,c=function(b){return a.isArray(b)},d=function(a){return!c(a)&&a instanceof Object},e=function(a){return a instanceof Function},f=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},g=function(){var a,b={};for(a=0;a<arguments.length;a+=1)f(arguments[a],function(a,c){b[c]=a});return b},h=function(a,b){var d;return c(a)?(d=[],f(a,function(a,c,e){b(a,c,e)&&d.push(a)})):(d={},f(a,function(a,c,e){b(a,c,e)&&(d[c]=a)})),d},i=function(b,c){return a.inArray(c,b)},j=function(a,b){return h(a,function(a,c){return-1===i(b,c)})},k=function(a,b){return function(){(b||function(){}).apply(a,arguments)}},l=function(a){return/\[\]$/.test(a)},m=function(a,b){return a.substring(0,a.length-1)+b+"]"},n=function(b){var c={};return b.each(function(){var b=a(this).attr("name");b&&(c[b]||(c[b]=[]),c[b].push(a(this)))}),c},o=function(){return b.find('input[type="checkbox"], input[type="radio"], input[type="text"], input[type="hidden"], textarea, select')},p=function(a){var b=function(a){var b={};return f(a,function(a,e){!function g(a,e){d(e)||c(e)?f(e,function(b,c){g(a+"["+c+"]",b)}):b[a]=e}(e,a)}),b},e=function(){var a=n(o()),b={},c=function(a,c){var d=function(){return a.is('input[type="checkbox"]')||a.is('input[type="radio"]')},e=function(){return d()?a.is(":checked")?a.val():void 0:a.val()},f=e();(d()&&f||!d())&&(b[c]=f)};return f(a,function(a,b){l(b)?f(a,function(a,d){c(a,m(b,d))}):a.length>1?f(a,function(a){c(a,b)}):c(a[0],b)}),b};return a?b(a):e()},q=function(b){if(b){var c=b.match(/#@#.*#@#/gim);return c&&c[0]?(c=c[0].substring(3,c[0].length-3),c=a.parseJSON(c)):null}return null},r=function(a){return a?a.replace(/#@#.*#@#/gim,""):null},s=function(a,b){b.is('input[type="text"]')||b.is("select")||b.is('input[type="hidden"]')||b.is("textarea")?b.val(a):(b.is('input[type="checkbox"]')||b.is('input[type="radio"]'))&&(""===a||null===a?b.prop("checked",!1):b.filter('[value="'+a+'"]').prop("checked",!0))},t=function(c){c=c||b,c.find('input[type="file"]').each(function(){a(this).wrap("<form>").closest("form").get(0).reset(),a(this).unwrap()})},u=function(c){c=c||!1,o().not('input[type="hidden"]').each(function(){s("",a(this))}),c&&b.find('input[type="hidden"]').each(function(){s("",a(this))}),t()},v=function(a){return e(a)?a.apply({clear:u,clearFileInputs:t,set:function(a,c){s(c,b.find('[name="'+a+'"]'))},get:p},Array.prototype.slice.call(arguments,1)):void 0},w=function(a,b,c){var d=a.response,e=a.metaData,f=e&&e.status||d&&d.status||200;!f||f>=200&&300>f?v(b,d,e):v(c,d,e)},x=function(b,c){var d=q(b);return b=r(b),"json"===c.toLowerCase()&&(b=a.parseJSON(b)),{metaData:d,response:b}},y=function(c){var d=function(){var a=function(a,b){return l(a)?m(a,b):a},c=n(b.find('input[type="file"]')),d={};return f(c,function(b,c){f(b,function(b,e){d[a(c,e)]=b})}),d};b.submit(function(b){console.log("ajax2"),b.preventDefault();var e=A(c());if(!e.validate||e.validate()){var h=new FormData;f(e.data,function(a,b){h.append(b,a)}),f(d(),function(a,b){var c=a[0];c.files.length>0&&(1===c.files.length?h.append(b,c.files[0]):f(c.files,function(a,c){h.append(b+"["+c+"]",a)}))}),a.ajax(j(g(e,{processData:!1,contentType:!1,data:null,type:"POST",dataType:"text",beforeSend:function(a,b){b.xhr=function(){var a=new window.XMLHttpRequest;return a.upload.onprogress=k(this,e.onprogress),a.upload.onload=k(this,e.onload),a.upload.onerror=k(this,e.onerror),a.upload.onabort=k(this,e.onabort),a},b.data=h,v(e.beforeSend)},success:function(a){var b=x(a,e.dataType);w(b,e.success,e.error)},error:function(a){var b=x(a.responseText,e.dataType);v(e.error,b.response,b.metaData)},complete:function(a){var b=x(a.responseText,e.dataType);v(e.complete,b.response,b.metaData)}})),["$files","getData"])}})},z=function(c){b.submit(function(d){d.stopPropagation(),console.log("iframeAjax");var e=A(c());if(!e.validate||e.validate()){var g="file-ajax-id-"+(new Date).getTime();a("body").prepend('<iframe width="0" height="0" style="display:none;" name="'+g+'" id="'+g+'"/>');var h={};o().each(function(){var b=a(this).attr("name");b&&(h[b]=a(this))});var i=function(){f(h,function(a){a.removeAttr("name")})},j=function(){f(h,function(a,b){a.attr("name",b)})},k=a("#"+g);v(e.beforeSend),k.on("load",function(){var a=k.contents().find("body").html(),b=x(a,e.dataType);w(b,e.success,e.error),j(),m(),k.remove(),v(e.complete,b.response,b.metaData)}),i();var l=[];f(e.data,function(c,d){var e=a('<input type="hidden" name="'+d+'" value="'+c+'"/>');b.prepend(e),l.push(e)});var m=function(){f(l,function(a){a.remove()})};b.attr({target:g,action:e.url,method:"POST",enctype:"multipart/form-data"})}else d.preventDefault()})},A=function(a){return a.url=a.url||b.attr("action"),a.data=p(a.data),a},B=function(c,d){if(b=a(this),!b.is("form"))throw"selected element must be a form element";a.support.ajax&&"undefined"!=typeof FormData&&d!==!0?y(c):z(c)};B.clearFileInputs=t,a.fn.fileAjax=B,a.fileAjax=B}(jQuery);var a=function(a){return a},b=function(a){return $.isArray(a)},c=function(a){return!b(a)&&a instanceof Object},d=function(a){return a instanceof Function},e=function(a){return parseInt(a,10)},f=function(a){var b=Array.prototype.slice.call(arguments,1);return d(a)?function(){var c=Array.prototype.slice.call(arguments);return a.apply(null,b.concat(c))}:void 0},g=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b]);return c},h=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},i=function(a,b){return $.inArray(b,a)},j=function(a,b){return-1!==i(a,b)},k=function(a){return $.extend(!0,{},a)},l=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},m=function(a,b){var c,d,e,f=[];for(void 0===b?(d=0,e=a-1):(d=a,e=b),c=d;e>=c;c+=1)f.push(c);return f},n=function(a){return a[a.length-1]},o=function(a,b){var c=[];return l(a,function(a,d,e){c.push(b(a,d,e))}),c},p=function(a,b,c){var d={};return l(a,function(a,e,f){e=c?c(e,a):e,d[e]=b(a,e,f)}),d},q=function(a,c,d){return b(a)?o(a,c):p(a,c,d)},r=function(a,b,c){return q(a,function(a){return a[b].apply(a,c||[])})},s=function(a){return o(a,function(a,b){return b})},t=function(a,c){var d;return b(a)?(d=[],l(a,function(a,b,e){c(a,b,e)&&d.push(a)})):(d={},l(a,function(a,b,e){c(a,b,e)&&(d[b]=a)})),d},u=function(){var a,b={};for(a=0;a<arguments.length;a+=1)l(arguments[a],function(a,c){b[c]=a});return b},v=function(a,b){return t(a,function(a,c){return-1!==i(b,c)})},w=function(a,b){return t(a,function(a,c){return-1===i(b,c)})},x=function(a){var b=Array.prototype.slice.call(arguments,1);return d(a)?a.apply(null,b):void 0},y=(function(){var a=0;return function(){return a+=1}}(),function(a){a=a||{};var b={};return a.publish=function(a,c){l(b[a],function(a){a(c)})},a.subscribe=function(a,c){b[a]=b[a]||[],b[a].push(c)},a.unsubscribe=function(a){l(b,function(b){var c=i(b,a);-1!==c&&b.splice(c,1)})},a}),z=function(){var a={},b=function(a){var b,c,d,e="",f="",g=function(){var b=-1!==i(a,"#"),c=-1!==i(a,"?"),d="";return c&&(d=a.split("?")[1]||"",b&&(d=d.split("#")[0]||"")),e=c?a.split("?")[0]||"":b?a.split("#")[0]||"":a,b&&(f=a.split("#")[1]||""),d?d.split("&"):[]},h=g(a),j={};for(d=0;d<h.length;d+=1)b=h[d].split("=")[0],c=h[d].split("=")[1],j[b]=c;return{url:e||"",hash:f||"",parameters:j}},c=function(a){var b=[];return l(a.parameters,function(c,d){b.push(d+"="+a.parameters[d])}),a.url+(b.length>0?"?"+b.join("&"):"")+(a.hash?"#"+a.hash:"")};return a.get=function(a){return b(a).parameters},a.set=function(a,d){var e=b(a);return e.parameters=u(e.parameters,d),c(e)},a}(),A=function(a,b,c){return $(a+(c?"-"+c:"")+(b?"-"+b:""))},B=f(A,".frm"),C=function(a){var b={},c=a.url,d=a.name,e=a.fieldMap||{},h=a.uniquelyIdentifyingFields,i=a.deleteConfirmation,j=f(B,d),k=function(a,b){return function(){var c=g(arguments);return b.length?a.apply(null,[b].concat(c)):void 0}};b.input={text:L,textarea:M,select:K,radio:J,checkbox:H,file:I,button:G,hidden:N};var l=function(a){return q(O({$:a,factory:b}),function(a){return P({input:a})})};return b.form=k(function(b){return R({$:b,ajax:D,validate:a.validate,onprogress:a.onprogress,success:a.success,error:a.error,complete:a.complete,url:c,inputs:l(b)})},j("")),b.list=k(function(a,b){return Y({$:a,fieldMap:e,request:b,uniquelyIdentifyingFields:h,deleteConfirmation:i})},j("list")),b.newItemButton=k(function(a){return Z({$:a})},j("new")),b.request=function(){return W({ajax:function(a){$.ajax(a)},url:c})},b.search=k(function(a,b){return S({$:a,request:b,inputs:l(a)})},j("search")),b.ordinator=k(function(b,c){return T({$:b,request:c,orderIcons:a.orderIcons})},j("ordinator")),b.paginator=function(a){return V({name:d,request:a,gotoPage:b.gotoPage()})},b.gotoPage=k(function(a){return U({$:a,inputs:l(a)})},j("goto-page")),b},D=function(b,d){var e=function(){var a=d();return a.type=a.type||"POST",a.dataType=a.dataType?a.dataType.toLowerCase():"json",a},f=function(){var b=e();return b.data=q(b.data||{},a,function(a){return a.replace(/\[\]$/,"")}),b};b.find('input[type="file"]').length?(console.log("$.fn.fileAjax"),b.fileAjax(f,!1)):(console.log("$.ajax"),b.submit(function(a){a.preventDefault();var b=e();b.validate()&&$.ajax({url:b.url,type:b.type,data:b.data,dataType:b.dataType,beforeSend:b.beforeSend,success:function(a){c(a)&&(a.status<200||a.status>=300)?x(b.error,a):x(b.success,a)},error:function(a){x(b.error,"json"===b.dataType?a.responseJSON:a.responseText)},complete:function(a){x(b.complete,"json"===b.dataType?a.responseJSON:a.responseText)}})}))},E=function(a){var b=y(),c=a.$;return b.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},b.$=function(a){return a?c.find(a):c},b.disable=function(){b.$().prop("disabled",!0),b.publish("isEnabled",!1)},b.enable=function(){b.$().prop("disabled",!1),b.publish("isEnabled",!0)},b},F=function(a,b){var c=E(a,b);return c.get=function(){return c.$().val()},c.set=function(a){var b=c.get();b!==a&&(c.$().val(a),c.publish("change",a))},c.clear=function(){c.set("")},b.buildSetter=function(a){return function(b){var d=c.get();d!==b&&(a.call(c,b),c.publish("change",b))}},c},G=function(a){var b={},c=F(a,b);return c.getType=function(){return"button"},c},H=function(a){var c={},d=F(a,c);return d.getType=function(){return"checkbox"},d.get=function(){var a=[];return d.$().filter(":checked").each(function(){$(this).is(":checked")&&a.push($(this).val())}),a},d.set=function(a){a=b(a)?a:[a];var c=d.get(),e=!1;c.length===a.length?l(c,function(b){-1===i(a,b)&&(e=!0)}):e=!0,e&&(d.$().each(function(){$(this).prop("checked",!1)}),l(a,function(a){d.$().filter('[value="'+a+'"]').prop("checked",!0)}),d.publish("change",a))},d.$().click(function(){d.publish("change",d.get())}),d},I=function(a){var b={},c=E(a,b);return c.getType=function(){return"file"},c.get=function(){return n(c.$().val().split("\\"))},c.clear=function(){$.fileAjax.clearFileInputs(c.$().parent())},c.$().change(function(){c.publish("change",c.get())}),c},J=function(a){var b={},c=F(a,b);return c.getType=function(){return"radio"},c.get=function(){return c.$().filter(":checked").val()||null},c.set=b.buildSetter(function(a){a?c.$().filter('[value="'+a+'"]').prop("checked",!0):c.$().prop("checked",!1)}),c.$().change(function(){c.publish("change",c.get())}),c},K=function(a){var b={},c=F(a,b);return c.getType=function(){return"select"},c.$().change(function(){c.publish("change",c.get())}),c},L=function(a){var b={},c=F(a,b);return c.getType=function(){return"text"},c.$().keyup(function(){c.publish("change",c.get())}),c},M=function(a){var b={},c=F(a,b);return c.getType=function(){return"textarea"},c.$().keyup(function(){c.publish("change",c.get())}),c},N=function(a){var b={},c=F(a,b);return c.getType=function(){return"hidden"},c.$().keyup(function(){c.publish("change",c.get())}),c},O=function(a){var b=a.$,c=a.factory,d={},e=function(a,e,f){f=f||d,b.find(e).each(function(){var b=$(this).attr("name");f[b]=c.input[a]({$:$(this)})})};e("text",'input[type="text"]'),e("textarea","textarea"),e("select","select"),e("file",'input[type="file"]'),e("button",'input[type="button"], input[type="submit"]'),e("hidden",'input[type="hidden"]');var f=function(a,e){var f=[];b.find(e).each(function(){-1===i(f,$(this).attr("name"))&&f.push($(this).attr("name"))}),l(f,function(e){d[e]=c.input[a]({$:b.find('input[name="'+e+'"]')})})};return f("radio",'input[type="radio"]'),f("checkbox",'input[type="checkbox"]'),d},P=function(a){var b={},c=a.input,d=c.$().closest(".frm-group");return b.get=c.get||function(){},b.set=c.set||function(){},b.clear=c.clear||function(){},b.disable=c.disable,b.enable=c.enable,b.getType=c.getType,b.$=function(a){return a?d.find(a):d},function(){var a=null,c=!1;b.setFeedback=function(d){c||b.$().addClass("error"),d!==a&&b.$(".frm-feedback").html(d),a=d,c=!0},b.clearFeedback=function(){c&&(b.$().removeClass("error"),b.$(".frm-feedback").html("")),a=null,c=!1}}(),b},Q=function(a){var b=y(),d=a.$,e=d.find(".frm-global-feedback"),f=a.inputs;!function(){var a=!1,c=null;b.setGlobalFeedback=function(f){b.clearGlobalSuccess(),a||d.addClass("error"),f!==c&&e.html(f),a=!0,c=f},b.clearGlobalError=function(){a&&d.removeClass("error"),c&&e.html(""),a=!1,c=null}}(),function(){var a=!1,c=null;b.setGlobalSuccess=function(f){b.clearFeedback(),a||d.addClass("success"),f!==c&&e.html(f),a=!0,c=f},b.clearGlobalSuccess=function(){a&&d.removeClass("success"),c&&e.html(""),a=!1,c=null}}(),b.clearGlobalFeedback=function(){b.clearGlobalError(),b.clearGlobalSuccess()},b.setFeedback=function(a){a=a||{},b.clearFeedback(),l(v(f,s(a)),function(b,c){b.setFeedback(a[c])}),b.setGlobalFeedback(a.GLOBAL)},b.validate=a.validate||function(){return{}};var h=function(){var a=g(arguments);return t(f,function(b){return!j(a,b.getType())})},i=function(){var a=g(arguments);return t(f,function(b){return j(a,b.getType())})};return b.clearFeedback=function(){r(f,"clearFeedback"),b.clearGlobalFeedback()},b.disable=function(){r(h("file"),"disable")},b.enable=function(){r(f,"enable")},b.get=function(){return r(h("file","button"),"get")},b.set=function(a,d){c(a)?l(a,function(a,c){b.set(c,a)}):f[a]&&f[a].set(d)},b.clear=function(a){a=a||{};var b=a.isClearHidden?["button"]:["button","hidden"];r(h.apply(null,b),"clear")},function(){var a=b.get();b.reset=function(){r(i("file"),"clear"),b.set(k(a))}}(),b},R=function(a){var b=Q(a),c=a.ajax,d=a.url||a.$.attr("action");return b.setAction=function(a){d=z.set(d,{action:a})},c(a.$,function(){return{url:d,dataType:"json",data:b.get(),validate:function(){var a=b.validate(b.get());return h(a)?!0:(b.setFeedback(a),b.publish("error",a),!1)},onprogress:function(b){x(f(a.onprogress,b)),console.log(b.loaded,b.total)},beforeSend:function(){x(a.beforeSend),b.disable(),b.publish("beforeSend")},success:function(c){x(f(a.success,c)),c=c||{},b.setGlobalSuccess(c.successMessage),b.publish("success",c)},error:function(c){x(f(a.error,c)),b.setFeedback(c),b.publish("error",c)},complete:function(c){x(a.complete,c),b.enable(),b.publish("complete",c)}}}),b},S=function(a){var b=Q(a),c=a.$,d=a.request;return c.submit(function(a){a.preventDefault(),d.setFilter(b.get()),d.setPage(1),d.search()}),b},T=function(a){var b={},c=a.$,d=a.request,e=a.orderIcons||{neutral:"&#8597;",ascending:"&#8593;",descending:"&#8595;"},f=function(){var a={};return c.find("[data-field]").each(function(){var b=$(this);a[b.data("field")]=function(){var a={},c=b.is("[data-order]")?b:b.find("[data-order]"),d=c.data("order")||"neutral";return a.set=function(a){c.data("order",a),c.html(e[a]),d=a},a.get=function(){return d},a.next=function(){var b=["ascending","descending"],c=b[(i(b,d)+1)%b.length];a.set(c)},a}()}),a}();return c.find("[data-field]").click(function(){var a=$(this).data("field");r(w(f,[a]),"set",["neutral"]),f[a].next(),d.setOrder(q(r(f,"get"),function(a){return"neutral"===a?"":a})),d.setPage(1),d.search()}),b},U=function(a){var b=Q(a),c=a.$;return c.submit(function(a){a.preventDefault(),b.publish("submit",b.get())}),b},V=function(a){var b={},c=a.name,d=a.request,f=a.gotoPage,g=u({noPage:"Must enter a page number.",notAnInteger:"Must enter valid page number.",nonPositiveNumber:"Page number must be positive.",pageNumberOutOfBounds:"Page number cannot exceed the total number of pages."},a.errorMessages||{}),i=$(".frm-number-of-pages-"+c),j=$(".frm-number-of-results-"+c),k=$(".frm-page-numbers-"+c),o=($(".frm-goto-page-"+c),$(".frm-previous-"+c)),p=$(".frm-next-"+c),q=function(a){return a.is("data-number")?a:a.find("[data-number]")},s=e(q(k.find(".frm-number-container.selected")).data("number"))||1,v=e(i.html())||s,w=e(j.html())||null,x=function(){var a=k.find(".frm-number-container:first-child").clone();return a.removeClass("selected"),q(a).html("").data("number",""),a}(),y=function(a){a=e(a),a!==v&&(i.html(a),v=a)},z=function(a){a=e(a),a!==w&&(j.html(a),w=a)},A=function(){for(var a=m(s-3,s+3);a[0]<1;)a.shift(),a.push(n(a)+1);for(;!h(a)&&n(a)>v;)a.pop();for(;a.length<7&&a[0]>1;)a.unshift(a[0]-1);return a},B=function(a){s=a,d.setPage(a),d.search()},C=function(a){var b={},c=a.$,d=c.find("[data-number]"),f=a.pageNumber||e(d.data("number"));return b.set=function(a){a=e(a),f!==a&&(d.html(a),f=a)},b.get=function(){return f},b.setSelected=function(){c.addClass("selected")},b.clearSelected=function(){c.removeClass("selected")},b.destroy=function(){c.remove()},d.html(f),c.click(function(){B(f)}),b},D=function(){return D=[],k.find(".frm-number-container").each(function(){D.push(C({$:$(this)}))}),D}(),E=function(a){var b=t(D,function(b){return b.get()===a});return h(b)?null:b[0]},F=function(){r(D,"clearSelected");var a=E(s);a&&a.setSelected()},G=function(){var a=0;for(l(A(),function(b){if(D[a])D[a].set(b);else{var c=x.clone();k.append(c),D[a]=C({pageNumber:b,$:c})}a+=1});D[a];)D[a].destroy(),D.splice(a,1);F()};return b.validate=function(a,b){var c={},d=e(a.page);return a.page?isNaN(d)?c.page=g.notAnInteger:0>=d?c.page=g.nonPositiveNumber:d>b&&(c.page=g.pageNumberOutOfBounds):c.page=g.noPage,c},d.subscribe("success",function(a){(0===e(a.numberOfPages)||a.numberOfPages)&&y(a.numberOfPages),a.numberOfResults&&z(a.numberOfResults),G()}),d.subscribe("setPage",function(a){s=a}),f&&f.subscribe("submit",function(a){var c=b.validate(a,v);h(c)?(f.clearFeedback(),f.reset(),B(e(a.page))):f.setFeedback(c)}),o.click(function(){h(b.validate({page:s-1},v))&&B(s-1)}),p.click(function(){h(b.validate({page:s+1},v))&&B(s+1)}),b},W=function(c){var d=y(),e=c.ajax,f=c.url,g={},h=function(){return z.set(f,t(g||{},function(a){return b(a)?a.length:a||0===a}))},i=function(a){g=u(g,a)};return d.setOrder=function(c){i(q(c,a,function(a){return"order_"+(b(a)?a.join(","):a)}))},d.setFilter=function(c){i(q(c,a,function(a){return"filter_"+(b(a)?a.join(","):a)}))},d.setPage=function(a){i({page:a}),d.publish("setPage",a)},d.search=function(){e({type:"GET",url:h(),dataType:"json",success:function(a){d.publish("success",a)},error:function(a){d.publish("error",a.responseJSON)},complete:function(a){d.publish("complete",a.responseJSON)}})},d["delete"]=function(a){e({type:"POST",url:z.set(f,u(a.uniquelyIdentifyingFields,{action:"delete"})),dataType:"json",success:a.success,error:function(b){x(a.error,b.responseJSON)},complete:function(b){x(a.complete,b.responseJSON)}})},d},X=function(c){var d=y(),e=c.$self,f=c.fieldMap||{},g=function(a){return b(a)?a.join(", "):a},h=function(a){l(a,function(a,b){e.find('[data-field="'+b+'"]').html(f[b]?f[b](a):g(a))})},i=function(){var a=function(a){return/^\[.*\]$/.test(a)?q(a.replace(/^\[/,"").replace(/\]$/,"").split(","),function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")}):a},b={};return e.find("[data-field]").each(function(){b[$(this).data("field")]=a($(this).data("value"))||""}),b},m=i();return h(m),d.set=function(b){var c=q(b,a,function(a){return j(s(m),a+"[]")?a+"[]":a}),e=t(c,function(a,b){return"undefined"==typeof m[b]?!1:m[b]!==a});return m=u(m,e),h(e),d},d.hardSet=function(a){d.clear(),d.set(a)},d.clear=function(){return e.find("[data-field]").html(""),e.find("[data-value]").attr("data-value",""),m=q(m,function(){return""}),d},d.destroy=function(){e.remove()},d.get=function(){return k(m)},d.addSelectedClass=function(){e.addClass("selected")},d.removeSelectedClass=function(){e.removeClass("selected")},e.dblclick(function(){d.publish("selected",d)}),e.find(".frm-edit-item").click(function(){d.publish("selected",d)}),e.find(".frm-delete-item").click(function(){d.publish("delete",d)}),d},Y=function(a){var d=y(),e=a.$,f=a.fieldMap||{},g=a.deleteConfirmation,h=a.uniquelyIdentifyingFields,j=a.request,k=function(){var a=e.find(".frm-list-item:first-child").clone(),b=X({$self:a,fieldMap:f});return b.clear(),a}(),m=function(a){a.subscribe("selected",function(){d.setSelectedClass(a),d.publish("selected",a)});var b=function(){var b=v(a.get(),h);j["delete"]({uniquelyIdentifyingFields:b,success:function(){d.remove(a),d.publish("deleted",a)},error:function(){},complete:function(){}})};return a.subscribe("delete",function(){if(g)g(b);else{var a=confirm("Are you sure you want to delete this item?");a&&b()}}),a},n=function(){var a=[];return e.find(".frm-list-item").each(function(){a.push(m(X({$self:$(this),fieldMap:f})))}),a}();return d.setSelectedClass=function(a){d.clearSelectedClass(),a.addSelectedClass()},d.clearSelectedClass=function(){r(n,"removeSelectedClass")},d.set=function(a){var b=[];l(a,function(a,c){var d;n[c]?n[c].hardSet(a):(d=k.clone(),b.push(d),n[c]=m(X({$self:d,fieldMap:f})),n[c].set(a))}),e.append(b),n.length>a.length&&r(n.splice(a.length,n.length-a.length),"destroy")},d.remove=function(a){-1!==i(n,a)&&n.splice(i(n,a),1),a.destroy()},d.prepend=function(a){var b=k.clone(),c=m(X({$self:b,fieldMap:f}));return c.set(a),n.unshift(c),e.prepend(b),c},j.subscribe("success",function(a){d.set(c(a)&&b(a.results)?a.results:[])}),d},Z=function(a){var b=y(),c=a.$;return c.click(function(){b.publish("click")}),b},_={};_.init=function(a){var d={},e=a.name,f=C(a),g=f.form(),h=f.newItemButton(),i=f.request(),j=f.list(i),k=(f.search(i),f.ordinator(i),f.paginator(i),null),l=null;d.reset=function(){g&&(g.reset(),g.setAction("create")),j&&j.clearSelectedClass(),l=null,k=null},d.clearFormFeedback=function(){g&&g.clearFeedback()},g.setAction("create"),j&&g&&(j.subscribe("selected",function(a){g.set(a.get()),g.setAction("update"),l=a}),g.subscribe("beforeSend",function(){k=g.get()}),g.subscribe("success",function(){l&&k?l.set(k):k&&(l=j.prepend(k),j.setSelectedClass(l)),d.reset()}),h&&h.subscribe("click",function(){d.reset(),d.clearFormFeedback()}));var m=$(".frm-no-results-"+e);return j&&(j.subscribe("deleted",function(a){l===a&&d.reset()}),i.subscribe("success",function(a){d.reset(),!c(a)&&!b(a.results)||0===a.results.length?m.show():m.hide()})),d},window.forminator=_}();