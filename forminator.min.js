// forminator version 0.0.0
// https://github.com/DubFriend/forminator
// (MIT) 10-02-2014
// Brian Detering <BDeterin@gmail.com> (http://www.briandetering.net/)
!function(){"use strict";{var a=function(a){return $.isArray(a)},b=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},c=function(a,b){return $.inArray(b,a)},d=function(a,b){return-1!==c(a,b)},e=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},f=function(a,b){var c=[];return e(a,function(a,d,e){c.push(b(a,d,e))}),c},g=function(a,b,c){var d={};return e(a,function(a,e,f){e=c?c(e,a):e,d[e]=b(a,e,f)}),d},h=function(b,c,d){return a(b)?f(b,c):g(b,c,d)},i=function(a,b,c){e(a,function(a){a[b].apply(a,c||[])})},j=function(b,c){var d;return a(b)?(d=[],e(b,function(a,b,e){c(a,b,e)&&d.push(a)})):(d={},e(b,function(a,b,e){c(a,b,e)&&(d[b]=a)})),d},k=function(){var a,b={};for(a=0;a<arguments.length;a+=1)e(arguments[a],function(a,c){b[c]=a});return b},l=(function(){var a=0;return function(){return a+=1}}(),function(a){a=a||{};var b={};return a.publish=function(a,c){e(b[a],function(a){a(c)})},a.subscribe=function(a,c){b[a]=b[a]||[],b[a].push(c)},a.unsubscribe=function(a){e(b,function(b){var d=c(b,a);-1!==d&&b.splice(d,1)})},a});!function(){var a={},b=function(a){var b,d,e,f="",g="",h=function(){var b=-1!==c(a,"#"),d=-1!==c(a,"?"),e="";return d&&(e=a.split("?")[1]||"",b&&(e=e.split("#")[0]||"")),f=d?a.split("?")[0]||"":b?a.split("#")[0]||"":a,b&&(g=a.split("#")[1]||""),e?e.split("&"):[]},i=h(a),j={};for(e=0;e<i.length;e+=1)b=i[e].split("=")[0],d=i[e].split("=")[1],j[b]=d;return{url:f||"",hash:g||"",parameters:j}},d=function(a){var b=[];return e(a.parameters,function(c,d){b.push(d+"="+a.parameters[d])}),a.url+(b.length>0?"?"+b.join("&"):"")+(a.hash?"#"+a.hash:"")};return a.get=function(a){return b(a).parameters},a.set=function(a,c){var e=b(a);return e.parameters=k(e.parameters,c),d(e)},a}()}"undefined"==typeof console&&(console={},console.warn=function(){});var m=function(a){var b={},c=a.url,d=a.$;return b.input={text:v,textarea:w,select:u,radio:t,checkbox:r,file:s,button:q},b.form=function(){return y({$:d,ajax:n,url:c,inputs:x({$:d,factory:b})})},b},n=function(a){$.ajax(a)},o=function(a){var b=l(),c=a.$;return b.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},b.$=function(a){return a?c.find(a):c},b.disable=function(){b.$().prop("disabled",!0),b.publish("isEnabled",!1)},b.enable=function(){b.$().prop("disabled",!1),b.publish("isEnabled",!0)},b},p=function(a,b){var c=o(a,b);return c.get=function(){return c.$().val()},c.set=function(a){var b=c.get();b!==a&&(c.$().val(a),c.publish("change",a))},b.buildSetter=function(a){return function(b){var d=c.get();d!==b&&(a.call(c,b),c.publish("change",b))}},c},q=function(a){var b={},c=p(a,b);return c.getType=function(){return"button"},c},r=function(a){var b={},d=p(a,b);return d.getType=function(){return"checkbox"},d.get=function(){var a=[];return d.$().filter(":checked").each(function(){$(this).is(":checked")&&a.push($(this).val())}),a},d.set=function(a){a=a||[];var b=d.get(),f=!1;b.length===a.length?e(b,function(b){-1===c(a,b)&&(f=!0)}):f=!0,f&&(d.$().each(function(){$(this).prop("checked",!1)}),e(a,function(a){d.$().filter('[value="'+a+'"]').prop("checked",!0)}),d.publish("change",a))},d.$().click(function(){d.publish("change",d.get())}),d},s=function(a){var b={},c=o(a,b);return c.getType=function(){return"file"},c},t=function(a){var b={},c=p(a,b);return c.getType=function(){return"radio"},c.get=function(){return c.$().filter(":checked").val()},c.set=b.buildSetter(function(a){c.$().filter('[value="'+a+'"]').prop("checked",!0)}),c.$().change(function(){c.publish("change",c.get())}),c},u=function(a){var b={},c=p(a,b);return c.getType=function(){return"select"},c.$().change(function(){c.publish("change",c.get())}),c},v=function(a){var b={},c=p(a,b);return c.getType=function(){return"text"},c.$().keyup(function(){c.publish("change",c.get())}),c},w=function(a){var b={},c=p(a,b);return c.getType=function(){return"textarea"},c.get=function(){return c.$().html()},c.set=b.buildSetter(function(a){this.$().html(a)}),c.$().keyup(function(){c.publish("change",c.get())}),c},x=function(a){var b=a.$,d=a.factory,f={},g=function(a,c,e){e=e||f,b.find(c).each(function(){e[$(this).attr("name")]=d.input[a]({$:$(this)})})};g("text",'input[type="text"]'),g("textarea","textarea"),g("select","select"),g("file",'input[type="file"]'),g("button",'input[type="button"], input[type="submit"]');var h=function(a,g){var h=[];b.find(g).each(function(){-1===c(h,$(this).attr("name"))&&h.push($(this).attr("name"))}),e(h,function(c){f[c]=d.input[a]({$:b.find('input[name="'+c+'"]')})})};return h("radio",'input[type="radio"]'),h("checkbox",'input[type="checkbox"]'),f},y=function(a){var c=l(),e=a.$,f=a.ajax,g=a.url,k=a.inputs;return c.disable=function(){i(k,"disable")},c.enable=function(){i(k,"enable")},c.validate=function(){return{}},c.get=function(){return h(j(k,function(a){return!d(["file","button"],a.getType())}),function(a){return a.get()})},e.submit(function(a){a.preventDefault();var d=c.get(),e=c.validate(d);b(e)?f({url:g,method:"POST",data:d,dataType:"json",beforeSend:function(){c.disable()},success:function(){},error:function(a){console.log("error"),409===a.status&&c.publish("error",a.responseJSON)},complete:function(){c.enable()}}):console.log("error",e)}),c},z={};z.init=function(a){{var b=a.$,c=a.url,d=m({$:b,url:c});d.form()}},window.forminator=z}();