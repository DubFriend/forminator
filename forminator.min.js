// forminator version 0.1.3
// https://github.com/DubFriend/forminator
// (MIT) 27-04-2014
// Brian Detering <BDeterin@gmail.com> (http://www.briandetering.net/)
!function(){"use strict";!function(a){var b,c=function(b){return a.isArray(b)},d=function(a){return!c(a)&&a instanceof Object},e=function(a){return a instanceof Function},f=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},g=function(){var a,b={};for(a=0;a<arguments.length;a+=1)f(arguments[a],function(a,c){b[c]=a});return b},h=function(a,b){var d;return c(a)?(d=[],f(a,function(a,c,e){b(a,c,e)&&d.push(a)})):(d={},f(a,function(a,c,e){b(a,c,e)&&(d[c]=a)})),d},i=function(b,c){return a.inArray(c,b)},j=function(a,b){return h(a,function(a,c){return-1===i(b,c)})},k=function(a,b){return function(){(b||function(){}).apply(a,arguments)}},l=function(a){return/\[\]$/.test(a)},m=function(a,b){return a.substring(0,a.length-1)+b+"]"},n=function(b){var c={};return b.each(function(){var b=a(this).attr("name");b&&(c[b]||(c[b]=[]),c[b].push(a(this)))}),c},o=function(){return b.find('input[type="checkbox"], input[type="radio"], input[type="text"], input[type="hidden"], textarea, select')},p=function(a){var b=function(a){var b={};return f(a,function(a,e){!function g(a,e){d(e)||c(e)?f(e,function(b,c){g(a+"["+c+"]",b)}):b[a]=e}(e,a)}),b},e=function(){var a=n(o()),b={},c=function(a,c){var d=function(){return a.is('input[type="checkbox"]')||a.is('input[type="radio"]')},e=function(){return d()?a.is(":checked")?a.val():void 0:a.val()},f=e();(d()&&f||!d())&&(b[c]=f)};return f(a,function(a,b){l(b)?f(a,function(a,d){c(a,m(b,d))}):a.length>1?f(a,function(a){c(a,b)}):c(a[0],b)}),b};return a?b(a):e()},q=function(b){if(b){var c=b.match(/#@#.*#@#/gim);return c&&c[0]?(c=c[0].substring(3,c[0].length-3),c=a.parseJSON(c)):null}return null},r=function(a){return a?a.replace(/#@#.*#@#/gim,""):null},s=function(a,b){b.is('input[type="text"]')||b.is("select")||b.is('input[type="hidden"]')||b.is("textarea")?b.val(a):(b.is('input[type="checkbox"]')||b.is('input[type="radio"]'))&&(""===a||null===a?b.prop("checked",!1):b.filter('[value="'+a+'"]').prop("checked",!0))},t=function(c){c=c||b,c.find('input[type="file"]').each(function(){a(this).wrap("<form>").closest("form").get(0).reset(),a(this).unwrap()})},u=function(c){c=c||!1,o().not('input[type="hidden"]').each(function(){s("",a(this))}),c&&b.find('input[type="hidden"]').each(function(){s("",a(this))}),t()},v=function(a){return e(a)?a.apply({clear:u,clearFileInputs:t,set:function(a,c){s(c,b.find('[name="'+a+'"]'))},get:p},Array.prototype.slice.call(arguments,1)):void 0},w=function(a,b,c){var d=a.response,e=a.metaData,f=e&&e.status||d&&d.status||200;!f||f>=200&&300>f?v(b,d,e):v(c,d,e)},x=function(b,c){var d=q(b);return b=r(b),"json"===c.toLowerCase()&&(b=a.parseJSON(b)),{metaData:d,response:b}},y=function(c){var d=function(){var a=function(a,b){return l(a)?m(a,b):a},c=n(b.find('input[type="file"]')),d={};return f(c,function(b,c){f(b,function(b,e){d[a(c,e)]=b})}),d};b.submit(function(b){console.log("ajax2"),b.preventDefault();var e=A(c());if(!e.validate||e.validate()){var h=new FormData;f(e.data,function(a,b){h.append(b,a)}),f(d(),function(a,b){var c=a[0];c.files.length>0&&(1===c.files.length?h.append(b,c.files[0]):f(c.files,function(a,c){h.append(b+"["+c+"]",a)}))}),a.ajax(j(g(e,{processData:!1,contentType:!1,data:null,type:"POST",dataType:"text",beforeSend:function(a,b){b.xhr=function(){var a=new window.XMLHttpRequest;return a.upload.onprogress=k(this,e.onprogress),a.upload.onload=k(this,e.onload),a.upload.onerror=k(this,e.onerror),a.upload.onabort=k(this,e.onabort),a},b.data=h,v(e.beforeSend)},success:function(a){var b=x(a,e.dataType);w(b,e.success,e.error)},error:function(a){var b=x(a.responseText,e.dataType);v(e.error,b.response,b.metaData)},complete:function(a){var b=x(a.responseText,e.dataType);v(e.complete,b.response,b.metaData)}})),["$files","getData"])}})},z=function(c){b.submit(function(d){d.stopPropagation(),console.log("iframeAjax");var e=A(c());if(!e.validate||e.validate()){var g="file-ajax-id-"+(new Date).getTime();a("body").prepend('<iframe width="0" height="0" style="display:none;" name="'+g+'" id="'+g+'"/>');var h={};o().each(function(){var b=a(this).attr("name");b&&(h[b]=a(this))});var i=function(){f(h,function(a){a.removeAttr("name")})},j=function(){f(h,function(a,b){a.attr("name",b)})},k=a("#"+g);v(e.beforeSend),k.on("load",function(){var a=k.contents().find("body").html(),b=x(a,e.dataType);w(b,e.success,e.error),j(),m(),k.remove(),v(e.complete,b.response,b.metaData)}),i();var l=[];f(e.data,function(c,d){var e=a('<input type="hidden" name="'+d+'" value="'+c+'"/>');b.prepend(e),l.push(e)});var m=function(){f(l,function(a){a.remove()})};b.attr({target:g,action:e.url,method:"POST",enctype:"multipart/form-data"})}else d.preventDefault()})},A=function(a){return a.url=a.url||b.attr("action"),a.data=p(a.data),a},B=function(c,d){if(b=a(this),!b.is("form"))throw"selected element must be a form element";a.support.ajax&&"undefined"!=typeof FormData&&d!==!0?y(c):z(c)};B.clearFileInputs=t,a.fn.fileAjax=B,a.fileAjax=B}(jQuery);var a=function(){var a=function(a){return"string"==typeof a},b=function(a){return"[object Array]"===toString.call(a)},c=function(a){return!b(a)&&a instanceof Object},d=function(a){return"number"==typeof a},e=function(a){var b,c,d="";for(b=0;b<a.length;b+=1)switch(c=a.charAt(b)){case"<":d+="&lt;";break;case">":d+="&gt;";break;case"&":d+="&amp;";break;case"/":d+="&#x2F;";break;case'"':d+="&quot;";break;case"'":d+="&#x27;";break;default:d+=c}return d},f=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},g=32,h=function(i,j){var k,l,m,n;if(a(i))n=i.length,k="charForLoopStrategy"===j?e(i):"regexStrategy"===j?f(i):n>g?f(i):e(i);else if(d(i))k=i;else if(b(i))for(k=[],m=0;m<i.length;m+=1)k.push(h(i[m]));else if(c(i)){k={};for(l in i)i.hasOwnProperty(l)&&(k[l]=h(i[l]))}return k};return h}(),b=function(a){return a},c=function(a){return $.isArray(a)},d=function(a){return!c(a)&&a instanceof Object},e=function(a){return a instanceof Function},f=function(a){return parseInt(a,10)},g=function(a,b){return function(){return a.apply(b,arguments)}},h=function(a){var b=Array.prototype.slice.call(arguments,1);return e(a)?function(){var c=Array.prototype.slice.call(arguments);return a.apply(null,b.concat(c))}:void 0},i=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b]);return c},j=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},k=function(a,b){return $.inArray(b,a)},l=function(a,b){return-1!==k(a,b)},m=function(a){return $.extend(!0,{},a)},n=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},o=function(a,b){var c,d,e,f=[];for(void 0===b?(d=0,e=a-1):(d=a,e=b),c=d;e>=c;c+=1)f.push(c);return f},p=function(a){return a[a.length-1]},q=function(a,b){var c=[];return n(a,function(a,d,e){c.push(b(a,d,e))}),c},r=function(a,b,c){var d={};return n(a,function(a,e,f){e=c?c(e,a):e,d[e]=b(a,e,f)}),d},s=function(a,b,d){return c(a)?q(a,b):r(a,b,d)},t=function(a,b,c){return s(a,function(a){return a[b].apply(a,c||[])})},u=function(a){return q(a,function(a,b){return b})},v=function(a,b){var d;return c(a)?(d=[],n(a,function(a,c,e){b(a,c,e)&&d.push(a)})):(d={},n(a,function(a,c,e){b(a,c,e)&&(d[c]=a)})),d},w=function(){var a,b={};for(a=0;a<arguments.length;a+=1)n(arguments[a],function(a,c){b[c]=a});return b},x=function(a,b){return v(a,function(a,c){return-1!==k(b,c)})},y=function(a,b){return v(a,function(a,c){return-1===k(b,c)})},z=function(a){var b=Array.prototype.slice.call(arguments,1);return e(a)?a.apply(null,b):void 0},A=function(a,b,c){var d=null,e=!1;return function(){var f=this,g=arguments;null===d?(d=setTimeout(function(){(!c||e)&&b.apply(f,g),e=!1,d=null},a),c&&b.apply(f,g)):e=!0}},B=(function(){var a=0;return function(){return a+=1}}(),function(a){a=a||{};var b={};return a.publish=function(a,c){n(b[a],function(a){a(c)})},a.subscribe=function(a,c){b[a]=b[a]||[],b[a].push(c)},a.unsubscribe=function(a){n(b,function(b){var c=k(b,a);-1!==c&&b.splice(c,1)})},a}),C=function(){var a={},b=function(a){var b,c,d,e="",f="",g=function(){var b=-1!==a.indexOf("#"),c=-1!==a.indexOf("?"),d="";return c&&(d=a.split("?")[1]||"",b&&(d=d.split("#")[0]||"")),e=c?a.split("?")[0]||"":b?a.split("#")[0]||"":a,b&&(f=a.split("#")[1]||""),d?d.split("&"):[]},h=g(a),i={};for(d=0;d<h.length;d+=1)b=h[d].split("=")[0],c=h[d].split("=")[1],i[b]=c;return{url:e||"",hash:f||"",parameters:i}},c=function(a){var b=[];return n(a.parameters,function(c,d){b.push(d+"="+a.parameters[d])}),a.url+(b.length>0?"?"+b.join("&"):"")+(a.hash?"#"+a.hash:"")};return a.get=function(a){return b(a).parameters},a.set=function(a,d){var e=b(a);return e.parameters=w(e.parameters,d),c(e)},a}(),D=function(a,b,c){return $(a+(c?"-"+c:"")+(b?"-"+b:""))},E=h(D,".frm"),F=function(a){var b={},c=a.url,d=a.name,e=a.fieldMap||{},f=a.uniquelyIdentifyingFields,g=a.deleteConfirmation,j=h(E,d),k=function(a,b){return function(){var c=i(arguments);return b.length?a.apply(null,[b].concat(c)):void 0}};b.input={text:O,textarea:P,select:N,radio:M,checkbox:K,file:L,button:J,hidden:Q,range:R};var l=function(a){return s(S({$:a,factory:b}),function(a){return T({input:a})})};return b.form=k(function(b){return V({$:b,ajax:G,validate:a.validate,url:c,inputs:l(b)})},j("")),b.list=k(function(a,b){return bb({$:a,fieldMap:e,request:b,uniquelyIdentifyingFields:f,deleteConfirmation:g})},j("list")),b.newItemButton=k(function(a){return cb({$:a})},j("new")),b.request=function(){return _({ajax:function(a){$.ajax(a)},url:c})},b.search=k(function(b,c){return W({$:b,isInstantSearch:a.isInstantSearch===!1?!1:!0,request:c,inputs:l(b)})},j("search")),b.ordinator=k(function(b,c){return X({$:b,request:c,orderIcons:a.orderIcons})},j("ordinator")),b.paginator=function(a){return Z({name:d,request:a,gotoPage:b.gotoPage()})},b.gotoPage=k(function(a){return Y({$:a,inputs:l(a)})},j("goto-page")),b},G=function(a,c){var e=function(){var a=c();return a.type=a.type||"POST",a.dataType=a.dataType?a.dataType.toLowerCase():"json",a},f=function(){var a=e();return a.data=s(a.data||{},b,function(a){return a.replace(/\[\]$/,"")}),a};a.find('input[type="file"]').length?(console.log("$.fn.fileAjax"),a.fileAjax(f,!1)):a.submit(function(a){a.preventDefault();var b=e();b.validate()&&$.ajax({url:b.url,type:b.type,data:b.data,dataType:b.dataType,beforeSend:b.beforeSend,success:function(a){d(a)&&(a.status<200||a.status>=300)?z(b.error,a):z(b.success,a)},error:function(a){z(b.error,"json"===b.dataType?a.responseJSON:a.responseText)},complete:function(a){z(b.complete,"json"===b.dataType?a.responseJSON:a.responseText)}})})},H=function(a){var b=B(),c=a.$;return b.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},b.$=function(a){return a?c.find(a):c},b.disable=function(){b.$().prop("disabled",!0),b.publish("isEnabled",!1)},b.enable=function(){b.$().prop("disabled",!1),b.publish("isEnabled",!0)},b},I=function(a,b){var c=H(a,b);return c.get=function(){return c.$().val()},c.set=function(a){var b=c.get();b!==a&&(c.$().val(a),c.publish("change",c))},c.clear=function(){c.set("")},b.buildSetter=function(a){return function(b){var d=c.get();d!==b&&(a.call(c,b),c.publish("change",c))}},c},J=function(a){var b={},c=I(a,b);return c.getType=function(){return"button"},c},K=function(a){var b={},d=I(a,b);return d.getType=function(){return"checkbox"},d.get=function(){var a=[];return d.$().filter(":checked").each(function(){$(this).is(":checked")&&a.push($(this).val())}),a},d.set=function(a){a=c(a)?a:[a];var b=d.get(),e=!1;b.length===a.length?n(b,function(b){-1===k(a,b)&&(e=!0)}):e=!0,e&&(d.$().each(function(){$(this).prop("checked",!1)}),n(a,function(a){d.$().filter('[value="'+a+'"]').prop("checked",!0)}),d.publish("change",a))},d.$().click(function(){d.publish("change",d),d.publish("validate",d)}),d},L=function(a){var b={},c=H(a,b);return c.getType=function(){return"file"},c.get=function(){return p(c.$().val().split("\\"))},c.clear=function(){$.fileAjax.clearFileInputs(c.$().parent())},c.$().change(function(){c.publish("change",c),c.publish("validate",c)}),c},M=function(a){var b={},c=I(a,b);return c.getType=function(){return"radio"},c.get=function(){return c.$().filter(":checked").val()||null},c.set=b.buildSetter(function(a){a?c.$().filter('[value="'+a+'"]').prop("checked",!0):c.$().prop("checked",!1)}),c.$().change(function(){c.publish("change",c),c.publish("validate",c)}),c},N=function(a){var b={},c=I(a,b);return c.getType=function(){return"select"},c.$().change(function(){c.publish("change",c),c.publish("validate",c)}),c},O=function(a){var b={},c=I(a,b);return c.getType=function(){return"text"},c.$().keyup(A(200,function(){c.publish("change",c)})),c.$().blur(function(){c.publish("validate",c)}),c},P=function(a){var b={},c=I(a,b);return c.getType=function(){return"textarea"},c.$().keyup(A(200,function(){c.publish("change",c)})),c.$().blur(function(){c.publish("validate",c)}),c},Q=function(a){var b={},c=I(a,b);return c.getType=function(){return"hidden"},c.$().keyup(function(){c.publish("change",c)}),c},R=function(a){var b={},c=I(a,b);return c.getType=function(){return"range"},c.$().change(function(){c.publish("change",c),c.publish("validate",c)}),c},S=function(a){var b=a.$,c=a.factory,d={},e=function(a,e,f){f=f||d,b.find(e).each(function(){var b=$(this).attr("name");f[b]=c.input[a]({$:$(this)})})};e("text",'input[type="text"]'),e("text",'input[type="password"]'),e("text",'input[type="email"]'),e("text",'input[type="url"]'),e("range",'input[type="range"]'),e("textarea","textarea"),e("select","select"),e("file",'input[type="file"]'),e("button",'input[type="button"], input[type="submit"]'),e("hidden",'input[type="hidden"]');var f=function(a,e){var f=[];b.find(e).each(function(){-1===k(f,$(this).attr("name"))&&f.push($(this).attr("name"))}),n(f,function(e){d[e]=c.input[a]({$:b.find('input[name="'+e+'"]')})})};return f("radio",'input[type="radio"]'),f("checkbox",'input[type="checkbox"]'),d},T=function(b){var c={},d=b.input,e=d.$().closest(".frm-group"),f=e.find(".frm-feedback");return c.get=d.get||function(){},c.set=d.set||function(){},c.clear=d.clear||function(){},c.disable=d.disable,c.enable=d.enable,c.getType=d.getType,c.subscribe=d.subscribe,c.$=function(a){return a?e.find(a):e},c.setFeedback=function(b){c.$().removeClass("success"),c.$().addClass("error"),f.html(a(b||""))},c.clearFeedback=function(){c.$().removeClass("error"),f.html("")},c.setSuccess=function(b){c.$().removeClass("error"),c.$().addClass("success"),f.html(a(b||""))},c.clearSuccess=function(){c.$().removeClass("success"),f.html("")},c},U=function(b){var c=B(),e=b.$,f=e.find(".frm-global-feedback"),g=b.inputs||{};!function(){var b=!1,d=null;c.setGlobalFeedback=function(g){c.clearGlobalSuccess(),b||e.addClass("error"),g!==d&&f.html(a(g)),b=!0,d=g},c.clearGlobalError=function(){b&&e.removeClass("error"),d&&f.html(""),b=!1,d=null}}(),function(){var b=!1,d=null;c.setGlobalSuccess=function(g){c.clearFeedback(),b||e.addClass("success"),g!==d&&f.html(a(g)),b=!0,d=g},c.clearGlobalSuccess=function(){b&&e.removeClass("success"),d&&f.html(""),b=!1,d=null}}(),c.clearGlobalFeedback=function(){c.clearGlobalError(),c.clearGlobalSuccess()},c.setFeedback=function(a){a=a||{},c.clearFeedback(),n(x(g,u(a)),function(b,c){b.setFeedback(a[c])}),c.setGlobalFeedback(a.GLOBAL)},c.validate=b.validate||function(){return{}};var h=function(){var a=i(arguments);return v(g,function(b){return!l(a,b.getType())})},j=function(){var a=i(arguments);return v(g,function(b){return l(a,b.getType())})};return c.clearFeedback=function(){t(g,"clearFeedback"),c.clearGlobalFeedback()},c.disable=function(){t(h("file"),"disable")},c.enable=function(){t(g,"enable")},c.get=function(){return t(h("file","button"),"get")},c.set=function(a,b){d(a)?n(a,function(a,b){c.set(b,a)}):g[a]&&g[a].set(b)},c.clear=function(a){a=a||{};var b=a.isClearHidden?["button"]:["button","hidden"];t(h.apply(null,b),"clear")},function(){var a=c.get();c.reset=function(){t(j("file"),"clear"),c.set(m(a))}}(),c},V=function(a){var b=U(a),c=a.inputs||{},e=a.ajax,f=a.url||a.$.attr("action"),g="",h={},i=function(){return g?C.set(f,w({action:g},h)):f},k=a.fieldValidators||{};return b.setAction=function(a){g=a},b.setParameters=function(a){if(!d(a))throw"parameters must be an object";h=a},e(a.$,function(){return{url:i(),dataType:"json",data:b.get(),validate:function(){var a=b.validate(b.get());return j(a)?!0:(b.setFeedback(a),b.publish("error",{data:a,action:g}),!1)},onprogress:function(a){b.publish("onprogress",{data:a,action:g})},beforeSend:function(){b.disable(),b.publish("beforeSend",{action:g})},success:function(a){a=a||{},b.setGlobalSuccess(a.successMessage),b.publish("success",{data:a,action:g})},error:function(a){b.setFeedback(a),b.publish("error",{data:a,action:g})},complete:function(a){b.enable(),b.publish("complete",{data:a,action:g})}}}),n(c,function(a,b){a.subscribe("validate",function(){var c=null;k[b]&&(c=k[b](a.get())),c&&(c.isSuccess?a.setSuccess(c.message||""):a.setFeedback(c.message||""))})}),b},W=function(a){var b=U(a),c=a.$,d=a.request,e=a.isInstantSearch,f=a.inputs,g=function(){d.setFilter(b.get()),d.setPage(1),d.search()};return c.submit(function(a){a.preventDefault(),g()}),e&&n(f,function(a){a.subscribe("change",g)}),b},X=function(a){var b={},c=a.$,d=a.request,e=a.orderIcons||{neutral:"&#8597;",ascending:"&#8593;",descending:"&#8595;"},f=function(){var a={};return c.find("[data-field]").each(function(){var b=$(this);a[b.data("field")]=function(){var a={},c=b.is("[data-order]")?b:b.find("[data-order]"),d=c.data("order")||"neutral";return a.set=function(a){c.data("order",a),c.html(e[a]),d=a},a.get=function(){return d},a.next=function(){var b=["ascending","descending"],c=b[(k(b,d)+1)%b.length];a.set(c)},a}()}),a}();return c.find("[data-field]").click(function(a){a.preventDefault();var b=$(this).data("field");t(y(f,[b]),"set",["neutral"]),f[b].next(),d.setOrder(s(t(f,"get"),function(a){return"neutral"===a?"":a})),d.setPage(1),d.search()}),b},Y=function(a){var b=U(a),c=a.$;return c.submit(function(a){a.preventDefault(),b.publish("submit",b.get())}),b.show=function(){c.show()},b.hide=function(){c.hide()},b},Z=function(b){var c={},d=b.name,e=b.request,g=b.gotoPage,h=w({noPage:"Must enter a page number.",notAnInteger:"Must enter valid page number.",nonPositiveNumber:"Page number must be positive.",pageNumberOutOfBounds:"Page number cannot exceed the total number of pages."},b.errorMessages||{}),i=$(".frm-number-of-pages-"+d),k=$(".frm-number-of-results-"+d),l=$(".frm-page-numbers-"+d),m=($(".frm-goto-page-"+d),$(".frm-previous-"+d)),q=$(".frm-next-"+d),r=l.find(".frm-next-"+d),s=function(a){return a.is("data-number")?a:a.find("[data-number]")},u=f(s(l.find(".frm-number-container.selected")).data("number"))||1,x=f(i.html())||u,y=f(k.html())||null,z=function(){var a=$(l.find(".frm-number-container")[0]).clone();return a.removeClass("selected"),s(a).html("").data("number",""),a}(),A=function(b){b=f(b),b!==x&&(i.html(a(b)),x=b)},B=function(b){b=f(b),b!==y&&(k.html(a(b)),y=b)},C=function(){for(var a=o(u-3,u+3);a[0]<1;)a.shift(),a.push(p(a)+1);for(;!j(a)&&p(a)>x;)a.pop();for(;a.length<7&&a[0]>1;)a.unshift(a[0]-1);return a},D=function(a){u=a,e.setPage(a),e.search()},E=function(b){var c={},d=b.$,e=d.find("[data-number]"),g=b.pageNumber||f(e.data("number"));return c.set=function(b){b=f(b),g!==b&&(e.html(a(b)),g=b)},c.get=function(){return g},c.setSelected=function(){d.addClass("selected")},c.clearSelected=function(){d.removeClass("selected")},c.destroy=function(){d.remove()},e.html(a(g)),d.click(function(a){a.preventDefault(),D(g)}),c},F=function(){return F=[],l.find(".frm-number-container").each(function(){F.push(E({$:$(this)}))}),F}(),G=function(a){var b=v(F,function(b){return b.get()===a});return j(b)?null:b[0]},H=function(){t(F,"clearSelected");var a=G(u);a&&a.setSelected()},I=function(){var a=0;for(n(C(),function(b){if(F[a])F[a].set(b);else{var c=z.clone();r.length?c.insertBefore(r):l.append(c),F[a]=E({pageNumber:b,$:c})}a+=1});F[a];)F[a].destroy(),F.splice(a,1);H()};return c.show=function(){g&&g.show(),l.show(),m.show(),q.show()},c.hide=function(){g&&g.hide(),l.hide(),m.hide(),q.hide()},c.validate=function(a,b){var c={},d=f(a.page);return a.page?isNaN(d)?c.page=h.notAnInteger:0>=d?c.page=h.nonPositiveNumber:d>b&&(c.page=h.pageNumberOutOfBounds):c.page=h.noPage,c},e.subscribe("success",function(a){a=a||{};var b=a.data;(0===f(b.numberOfPages)||b.numberOfPages)&&A(b.numberOfPages),b.numberOfResults&&B(b.numberOfResults),I()}),e.subscribe("setPage",function(a){u=a}),g&&g.subscribe("submit",function(a){var b=c.validate(a,x);j(b)?(g.clearFeedback(),g.reset(),D(f(a.page))):g.setFeedback(b)}),m.click(function(a){a.preventDefault(),j(c.validate({page:u-1},x))&&D(u-1)}),q.click(function(a){a.preventDefault(),j(c.validate({page:u+1},x))&&D(u+1)}),c},_=function(a){var d=B(),e=a.ajax,f=a.url,g={},h=function(){return C.set(f,v(g||{},function(a){return c(a)?a.length:a||0===a}))},i=function(a){g=w(g,a)};return d.setOrder=function(a){i(s(a,b,function(a){return"order_"+(c(a)?a.join(","):a)}))},d.setFilter=function(a){i(s(a,b,function(a){return"filter_"+(c(a)?a.join(","):a)}))},d.setPage=function(a){i({page:a}),d.publish("setPage",a)},d.search=function(){e({type:"GET",url:h(),dataType:"json",success:function(a){d.publish("success",{data:a,action:"get"})},error:function(a){d.publish("error",{data:a.responseJSON,action:"get"})},complete:function(a){d.publish("complete",{data:a.responseJSON,action:"get"})}})},d["delete"]=function(a){e({type:"POST",url:C.set(f,w(a.uniquelyIdentifyingFields,{action:"delete"})),dataType:"json",success:function(b){a.success(b),d.publish("success",{data:b,action:"delete"})},error:function(b){z(a.error,b.responseJSON),d.publish("error",{data:b.responseJSON,action:"delete"})},complete:function(b){z(a.complete,b.responseJSON),d.publish("complete",{data:b.responseJSON,action:"delete"})}})},d},ab=function(d){var e=B(),f=d.$self,g=d.fieldMap||{},h=function(a){return c(a)?a.join(", "):a},i=function(b){n(a(b),function(a,b){f.find('[data-field="'+b+'"]').html(g[b]?g[b](a):h(a))})},j=function(){var a=function(a){return/^\[.*\]$/.test(a)?s(a.replace(/^\[/,"").replace(/\]$/,"").split(","),function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")}):a},b={};return f.find("[data-field]").each(function(){b[$(this).data("field")]=a($(this).data("value"))||""}),b},k=j();return i(k),e.get$=function(){return f},e.set=function(a){var c=s(a,b,function(a){return l(u(k),a+"[]")?a+"[]":a}),d=v(c,function(a,b){return"undefined"==typeof k[b]?!1:k[b]!==a});return k=w(k,d),i(d),e},e.hardSet=function(a){e.clear(),e.set(a)},e.clear=function(){return f.find("[data-field]").html(""),f.find("[data-value]").attr("data-value",""),k=s(k,function(){return""}),e},e.destroy=function(){f.remove()},e.get=function(){return m(k)},e.addSelectedClass=function(){f.addClass("selected")},e.removeSelectedClass=function(){f.removeClass("selected")},f.dblclick(function(){e.publish("selected",e)}),f.find(".frm-edit-item").click(function(){e.publish("selected",e)}),f.find(".frm-delete-item").click(function(){e.publish("delete",e)}),e},bb=function(a){var b=B(),e=a.$,f=a.fieldMap||{},g=a.deleteConfirmation,h=a.uniquelyIdentifyingFields,i=a.request,j=function(){var a=e.find(".frm-list-item:first-child").clone(),b=ab({$self:a,fieldMap:f});return b.clear(),a}(),l=function(a){a.subscribe("selected",function(){b.setSelectedClass(a),b.publish("selected",a)});var c=function(){var c=x(a.get(),h);i["delete"]({uniquelyIdentifyingFields:c,success:function(){b.remove(a),b.publish("deleted",a)}})};return a.subscribe("delete",function(){if(g)g(c);else{var a=confirm("Are you sure you want to delete this item?");a&&c()}}),a},m=function(){var a=[];return e.find(".frm-list-item").each(function(){a.push(l(ab({$self:$(this),fieldMap:f})))}),a}();return b.setSelectedClass=function(a){b.clearSelectedClass(),a.addSelectedClass()},b.clearSelectedClass=function(){t(m,"removeSelectedClass")},b.set=function(a){var b=[];n(a,function(a,c){var d;m[c]?m[c].hardSet(a):(d=j.clone(),b.push(d),m[c]=l(ab({$self:d,fieldMap:f})),m[c].set(a))}),e.append(b),m.length>a.length&&t(m.splice(a.length,m.length-a.length),"destroy")},b.remove=function(a){-1!==k(m,a)&&m.splice(k(m,a),1),a.destroy()},b.prepend=function(a){var b=j.clone(),c=l(ab({$self:b,fieldMap:f}));return c.set(a),m.unshift(c),e.prepend(b),c},i.subscribe("success",function(a){if("get"===a.action){a=a||{};var e=a.data;b.set(d(e)&&c(e.results)?e.results:[])}}),b},cb=function(a){var b=B(),c=a.$;return c.click(function(){b.publish("click")}),b},db={};db.init=function(a){var b={};a.validate=g(a.validate,b);var c=a.name,d=F(a),h=d.form(),i=d.newItemButton(),j=d.request(),k=d.list(j),l=(d.search(j),d.ordinator(j),d.paginator(j)),m=null,n=null,o=function(a){e(a)&&a.apply(b,Array.prototype.slice.call(arguments,1))},p=function(b,c){b&&b.subscribe(c,function(b){o(a[c],b.action,b.data)})};b.reset=function(){h&&(h.reset(),k&&h.setAction("create")),k&&k.clearSelectedClass(),n=null,m=null},b.clearFormFeedback=function(){h&&h.clearFeedback()},b.setFormParameters=function(a){h&&h.setParameters(a)},k&&h&&(h.setAction("create"),k.subscribe("selected",function(b){h.set(b.get()),h.setAction("update"),n=b,o(a.selected,b.get$())}),h.subscribe("beforeSend",function(){m=h.get()}),h.subscribe("success",function(a){a=a||{};var c=a.data||{};n&&m?n.set(m):m&&(n=k.prepend(w(m,c.fields||{})),k.setSelectedClass(n)),b.reset()}),i&&i.subscribe("click",function(){b.reset(),b.clearFormFeedback()}));var q=$(".frm-no-results-"+c);return k&&(k.subscribe("deleted",function(a){n===a&&b.reset()}),j.subscribe("success",function(a){a=a||{};var c=a.data?a.data.results||[]:[],d=a.data?f(a.data.numberOfPages):0;b.reset(),0!==c.length?q.hide():"get"===a.action&&q.show(),l&&(d>1?l.show():"get"===a.action&&l.hide())})),p(h,"onprogress"),p(h,"success"),p(h,"error"),p(h,"complete"),p(j,"success"),p(j,"error"),p(j,"complete"),b},window.forminator=db}();