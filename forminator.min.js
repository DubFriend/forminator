// forminator version 0.1.1
// https://github.com/DubFriend/forminator
// (MIT) 09-04-2014
// Brian Detering <BDeterin@gmail.com> (http://www.briandetering.net/)
!function(){"use strict";!function(a){var b,c=function(b){return a.isArray(b)},d=function(a){return!c(a)&&a instanceof Object},e=function(a){return a instanceof Function},f=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},g=function(){var a,b={};for(a=0;a<arguments.length;a+=1)f(arguments[a],function(a,c){b[c]=a});return b},h=function(a,b){var d;return c(a)?(d=[],f(a,function(a,c,e){b(a,c,e)&&d.push(a)})):(d={},f(a,function(a,c,e){b(a,c,e)&&(d[c]=a)})),d},i=function(b,c){return a.inArray(c,b)},j=function(a,b){return h(a,function(a,c){return-1===i(b,c)})},k=function(a,b){return function(){(b||function(){}).apply(a,arguments)}},l=function(a){return/\[\]$/.test(a)},m=function(a,b){return a.substring(0,a.length-1)+b+"]"},n=function(b){var c={};return b.each(function(){var b=a(this).attr("name");b&&(c[b]||(c[b]=[]),c[b].push(a(this)))}),c},o=function(){return b.find('input[type="checkbox"], input[type="radio"], input[type="text"], input[type="hidden"], textarea, select')},p=function(a){var b=function(a){var b={};return f(a,function(a,e){!function g(a,e){d(e)||c(e)?f(e,function(b,c){g(a+"["+c+"]",b)}):b[a]=e}(e,a)}),b},e=function(){var a=n(o()),b={},c=function(a,c){var d=function(){return a.is('input[type="checkbox"]')||a.is('input[type="radio"]')},e=function(){return d()?a.is(":checked")?a.val():void 0:a.val()},f=e();(d()&&f||!d())&&(b[c]=f)};return f(a,function(a,b){l(b)?f(a,function(a,d){c(a,m(b,d))}):a.length>1?f(a,function(a){c(a,b)}):c(a[0],b)}),b};return a?b(a):e()},q=function(b){if(b){var c=b.match(/#@#.*#@#/gim);return c&&c[0]?(c=c[0].substring(3,c[0].length-3),c=a.parseJSON(c)):null}return null},r=function(a){return a?a.replace(/#@#.*#@#/gim,""):null},s=function(a,b){b.is('input[type="text"]')||b.is("select")||b.is('input[type="hidden"]')||b.is("textarea")?b.val(a):(b.is('input[type="checkbox"]')||b.is('input[type="radio"]'))&&(""===a||null===a?b.prop("checked",!1):b.filter('[value="'+a+'"]').prop("checked",!0))},t=function(c){c=c||b,c.find('input[type="file"]').each(function(){a(this).wrap("<form>").closest("form").get(0).reset(),a(this).unwrap()})},u=function(c){c=c||!1,o().not('input[type="hidden"]').each(function(){s("",a(this))}),c&&b.find('input[type="hidden"]').each(function(){s("",a(this))}),t()},v=function(a){return e(a)?a.apply({clear:u,clearFileInputs:t,set:function(a,c){s(c,b.find('[name="'+a+'"]'))},get:p},Array.prototype.slice.call(arguments,1)):void 0},w=function(a,b,c){var d=a.response,e=a.metaData,f=e&&e.status||d&&d.status||200;!f||f>=200&&300>f?v(b,d,e):v(c,d,e)},x=function(b,c){var d=q(b);return b=r(b),"json"===c.toLowerCase()&&(b=a.parseJSON(b)),{metaData:d,response:b}},y=function(c){var d=function(){var a=function(a,b){return l(a)?m(a,b):a},c=n(b.find('input[type="file"]')),d={};return f(c,function(b,c){f(b,function(b,e){d[a(c,e)]=b})}),d};b.submit(function(b){console.log("ajax2"),b.preventDefault();var e=A(c());if(!e.validate||e.validate()){var h=new FormData;f(e.data,function(a,b){h.append(b,a)}),f(d(),function(a,b){var c=a[0];c.files.length>0&&(1===c.files.length?h.append(b,c.files[0]):f(c.files,function(a,c){h.append(b+"["+c+"]",a)}))}),a.ajax(j(g(e,{processData:!1,contentType:!1,data:null,type:"POST",dataType:"text",beforeSend:function(a,b){b.xhr=function(){var a=new window.XMLHttpRequest;return a.upload.onprogress=k(this,e.onprogress),a.upload.onload=k(this,e.onload),a.upload.onerror=k(this,e.onerror),a.upload.onabort=k(this,e.onabort),a},b.data=h,v(e.beforeSend)},success:function(a){var b=x(a,e.dataType);w(b,e.success,e.error)},error:function(a){var b=x(a.responseText,e.dataType);v(e.error,b.response,b.metaData)},complete:function(a){var b=x(a.responseText,e.dataType);v(e.complete,b.response,b.metaData)}})),["$files","getData"])}})},z=function(c){b.submit(function(d){d.stopPropagation(),console.log("iframeAjax");var e=A(c());if(!e.validate||e.validate()){var g="file-ajax-id-"+(new Date).getTime();a("body").prepend('<iframe width="0" height="0" style="display:none;" name="'+g+'" id="'+g+'"/>');var h={};o().each(function(){var b=a(this).attr("name");b&&(h[b]=a(this))});var i=function(){f(h,function(a){a.removeAttr("name")})},j=function(){f(h,function(a,b){a.attr("name",b)})},k=a("#"+g);v(e.beforeSend),k.on("load",function(){var a=k.contents().find("body").html(),b=x(a,e.dataType);w(b,e.success,e.error),j(),m(),k.remove(),v(e.complete,b.response,b.metaData)}),i();var l=[];f(e.data,function(c,d){var e=a('<input type="hidden" name="'+d+'" value="'+c+'"/>');b.prepend(e),l.push(e)});var m=function(){f(l,function(a){a.remove()})};b.attr({target:g,action:e.url,method:"POST",enctype:"multipart/form-data"})}else d.preventDefault()})},A=function(a){return a.url=a.url||b.attr("action"),a.data=p(a.data),a},B=function(c,d){if(b=a(this),!b.is("form"))throw"selected element must be a form element";a.support.ajax&&"undefined"!=typeof FormData&&d!==!0?y(c):z(c)};B.clearFileInputs=t,a.fn.fileAjax=B,a.fileAjax=B}(jQuery);var a=function(a){return a},b=function(a){return $.isArray(a)},c=function(a){return!b(a)&&a instanceof Object},d=function(a){return a instanceof Function},e=function(a){return parseInt(a,10)},f=function(a,b){return function(){return a.apply(b,arguments)}},g=function(a){var b=Array.prototype.slice.call(arguments,1);return d(a)?function(){var c=Array.prototype.slice.call(arguments);return a.apply(null,b.concat(c))}:void 0},h=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b]);return c},i=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},j=function(a,b){return $.inArray(b,a)},k=function(a,b){return-1!==j(a,b)},l=function(a){return $.extend(!0,{},a)},m=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},n=function(a,b){var c,d,e,f=[];for(void 0===b?(d=0,e=a-1):(d=a,e=b),c=d;e>=c;c+=1)f.push(c);return f},o=function(a){return a[a.length-1]},p=function(a,b){var c=[];return m(a,function(a,d,e){c.push(b(a,d,e))}),c},q=function(a,b,c){var d={};return m(a,function(a,e,f){e=c?c(e,a):e,d[e]=b(a,e,f)}),d},r=function(a,c,d){return b(a)?p(a,c):q(a,c,d)},s=function(a,b,c){return r(a,function(a){return a[b].apply(a,c||[])})},t=function(a){return p(a,function(a,b){return b})},u=function(a,c){var d;return b(a)?(d=[],m(a,function(a,b,e){c(a,b,e)&&d.push(a)})):(d={},m(a,function(a,b,e){c(a,b,e)&&(d[b]=a)})),d},v=function(){var a,b={};for(a=0;a<arguments.length;a+=1)m(arguments[a],function(a,c){b[c]=a});return b},w=function(a,b){return u(a,function(a,c){return-1!==j(b,c)})},x=function(a,b){return u(a,function(a,c){return-1===j(b,c)})},y=function(a){var b=Array.prototype.slice.call(arguments,1);return d(a)?a.apply(null,b):void 0},z=function(a,b,c){var d=null,e=!1;return function(){var f=this,g=arguments;null===d?(d=setTimeout(function(){(!c||e)&&b.apply(f,g),e=!1,d=null},a),c&&b.apply(f,g)):e=!0}},A=(function(){var a=0;return function(){return a+=1}}(),function(a){a=a||{};var b={};return a.publish=function(a,c){m(b[a],function(a){a(c)})},a.subscribe=function(a,c){b[a]=b[a]||[],b[a].push(c)},a.unsubscribe=function(a){m(b,function(b){var c=j(b,a);-1!==c&&b.splice(c,1)})},a}),B=function(){var a={},b=function(a){var b,c,d,e="",f="",g=function(){var b=-1!==a.indexOf("#"),c=-1!==a.indexOf("?"),d="";return c&&(d=a.split("?")[1]||"",b&&(d=d.split("#")[0]||"")),e=c?a.split("?")[0]||"":b?a.split("#")[0]||"":a,b&&(f=a.split("#")[1]||""),d?d.split("&"):[]},h=g(a),i={};for(d=0;d<h.length;d+=1)b=h[d].split("=")[0],c=h[d].split("=")[1],i[b]=c;return{url:e||"",hash:f||"",parameters:i}},c=function(a){var b=[];return m(a.parameters,function(c,d){b.push(d+"="+a.parameters[d])}),a.url+(b.length>0?"?"+b.join("&"):"")+(a.hash?"#"+a.hash:"")};return a.get=function(a){return b(a).parameters},a.set=function(a,d){var e=b(a);return e.parameters=v(e.parameters,d),c(e)},a}(),C=function(a,b,c){return $(a+(c?"-"+c:"")+(b?"-"+b:""))},D=g(C,".frm"),E=function(a){var b={},c=a.url,d=a.name,e=a.fieldMap||{},f=a.uniquelyIdentifyingFields,i=a.deleteConfirmation,j=g(D,d),k=function(a,b){return function(){var c=h(arguments);return b.length?a.apply(null,[b].concat(c)):void 0}};b.input={text:N,textarea:O,select:M,radio:L,checkbox:J,file:K,button:I,hidden:P,range:Q};var l=function(a){return r(R({$:a,factory:b}),function(a){return S({input:a})})};return b.form=k(function(b){return U({$:b,ajax:F,validate:a.validate,url:c,inputs:l(b)})},j("")),b.list=k(function(a,b){return ab({$:a,fieldMap:e,request:b,uniquelyIdentifyingFields:f,deleteConfirmation:i})},j("list")),b.newItemButton=k(function(a){return bb({$:a})},j("new")),b.request=function(){return Z({ajax:function(a){$.ajax(a)},url:c})},b.search=k(function(b,c){return V({$:b,isInstantSearch:a.isInstantSearch===!1?!1:!0,request:c,inputs:l(b)})},j("search")),b.ordinator=k(function(b,c){return W({$:b,request:c,orderIcons:a.orderIcons})},j("ordinator")),b.paginator=function(a){return Y({name:d,request:a,gotoPage:b.gotoPage()})},b.gotoPage=k(function(a){return X({$:a,inputs:l(a)})},j("goto-page")),b},F=function(b,d){var e=function(){var a=d();return a.type=a.type||"POST",a.dataType=a.dataType?a.dataType.toLowerCase():"json",a},f=function(){var b=e();return b.data=r(b.data||{},a,function(a){return a.replace(/\[\]$/,"")}),b};b.find('input[type="file"]').length?(console.log("$.fn.fileAjax"),b.fileAjax(f,!1)):(console.log("$.ajax"),b.submit(function(a){a.preventDefault();var b=e();b.validate()&&$.ajax({url:b.url,type:b.type,data:b.data,dataType:b.dataType,beforeSend:b.beforeSend,success:function(a){c(a)&&(a.status<200||a.status>=300)?y(b.error,a):y(b.success,a)},error:function(a){y(b.error,"json"===b.dataType?a.responseJSON:a.responseText)},complete:function(a){y(b.complete,"json"===b.dataType?a.responseJSON:a.responseText)}})}))},G=function(a){var b=A(),c=a.$;return b.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},b.$=function(a){return a?c.find(a):c},b.disable=function(){b.$().prop("disabled",!0),b.publish("isEnabled",!1)},b.enable=function(){b.$().prop("disabled",!1),b.publish("isEnabled",!0)},b},H=function(a,b){var c=G(a,b);return c.get=function(){return c.$().val()},c.set=function(a){var b=c.get();b!==a&&(c.$().val(a),c.publish("change",c))},c.clear=function(){c.set("")},b.buildSetter=function(a){return function(b){var d=c.get();d!==b&&(a.call(c,b),c.publish("change",c))}},c},I=function(a){var b={},c=H(a,b);return c.getType=function(){return"button"},c},J=function(a){var c={},d=H(a,c);return d.getType=function(){return"checkbox"},d.get=function(){var a=[];return d.$().filter(":checked").each(function(){$(this).is(":checked")&&a.push($(this).val())}),a},d.set=function(a){a=b(a)?a:[a];var c=d.get(),e=!1;c.length===a.length?m(c,function(b){-1===j(a,b)&&(e=!0)}):e=!0,e&&(d.$().each(function(){$(this).prop("checked",!1)}),m(a,function(a){d.$().filter('[value="'+a+'"]').prop("checked",!0)}),d.publish("change",a))},d.$().click(function(){d.publish("change",d)}),d},K=function(a){var b={},c=G(a,b);return c.getType=function(){return"file"},c.get=function(){return o(c.$().val().split("\\"))},c.clear=function(){$.fileAjax.clearFileInputs(c.$().parent())},c.$().change(function(){c.publish("change",c)}),c},L=function(a){var b={},c=H(a,b);return c.getType=function(){return"radio"},c.get=function(){return c.$().filter(":checked").val()||null},c.set=b.buildSetter(function(a){a?c.$().filter('[value="'+a+'"]').prop("checked",!0):c.$().prop("checked",!1)}),c.$().change(function(){c.publish("change",c)}),c},M=function(a){var b={},c=H(a,b);return c.getType=function(){return"select"},c.$().change(function(){c.publish("change",c)}),c},N=function(a){var b={},c=H(a,b);return c.getType=function(){return"text"},c.$().keyup(z(200,function(){c.publish("change",c)})),c},O=function(a){var b={},c=H(a,b);return c.getType=function(){return"textarea"},c.$().keyup(z(200,function(){c.publish("change",c)})),c},P=function(a){var b={},c=H(a,b);return c.getType=function(){return"hidden"},c.$().keyup(function(){c.publish("change",c)}),c},Q=function(a){var b={},c=H(a,b);return c.getType=function(){return"range"},c.$().change(function(){c.publish("change",c)}),c},R=function(a){var b=a.$,c=a.factory,d={},e=function(a,e,f){f=f||d,b.find(e).each(function(){var b=$(this).attr("name");f[b]=c.input[a]({$:$(this)})})};e("text",'input[type="text"]'),e("text",'input[type="password"]'),e("text",'input[type="email"]'),e("text",'input[type="url"]'),e("range",'input[type="range"]'),e("textarea","textarea"),e("select","select"),e("file",'input[type="file"]'),e("button",'input[type="button"], input[type="submit"]'),e("hidden",'input[type="hidden"]');var f=function(a,e){var f=[];b.find(e).each(function(){-1===j(f,$(this).attr("name"))&&f.push($(this).attr("name"))}),m(f,function(e){d[e]=c.input[a]({$:b.find('input[name="'+e+'"]')})})};return f("radio",'input[type="radio"]'),f("checkbox",'input[type="checkbox"]'),d},S=function(a){var b={},c=a.input,d=c.$().closest(".frm-group");return b.get=c.get||function(){},b.set=c.set||function(){},b.clear=c.clear||function(){},b.disable=c.disable,b.enable=c.enable,b.getType=c.getType,b.subscribe=c.subscribe,b.$=function(a){return a?d.find(a):d},function(){var a=null,c=!1;b.setFeedback=function(d){c||b.$().addClass("error"),d!==a&&b.$(".frm-feedback").html(d),a=d,c=!0},b.clearFeedback=function(){c&&(b.$().removeClass("error"),b.$(".frm-feedback").html("")),a=null,c=!1}}(),b},T=function(a){var b=A(),d=a.$,e=d.find(".frm-global-feedback"),f=a.inputs;!function(){var a=!1,c=null;b.setGlobalFeedback=function(f){b.clearGlobalSuccess(),a||d.addClass("error"),f!==c&&e.html(f),a=!0,c=f},b.clearGlobalError=function(){a&&d.removeClass("error"),c&&e.html(""),a=!1,c=null}}(),function(){var a=!1,c=null;b.setGlobalSuccess=function(f){b.clearFeedback(),a||d.addClass("success"),f!==c&&e.html(f),a=!0,c=f},b.clearGlobalSuccess=function(){a&&d.removeClass("success"),c&&e.html(""),a=!1,c=null}}(),b.clearGlobalFeedback=function(){b.clearGlobalError(),b.clearGlobalSuccess()},b.setFeedback=function(a){a=a||{},b.clearFeedback(),m(w(f,t(a)),function(b,c){b.setFeedback(a[c])}),b.setGlobalFeedback(a.GLOBAL)},b.validate=a.validate||function(){return{}};var g=function(){var a=h(arguments);return u(f,function(b){return!k(a,b.getType())})},i=function(){var a=h(arguments);return u(f,function(b){return k(a,b.getType())})};return b.clearFeedback=function(){s(f,"clearFeedback"),b.clearGlobalFeedback()},b.disable=function(){s(g("file"),"disable")},b.enable=function(){s(f,"enable")},b.get=function(){return s(g("file","button"),"get")},b.set=function(a,d){c(a)?m(a,function(a,c){b.set(c,a)}):f[a]&&f[a].set(d)},b.clear=function(a){a=a||{};var b=a.isClearHidden?["button"]:["button","hidden"];s(g.apply(null,b),"clear")},function(){var a=b.get();b.reset=function(){s(i("file"),"clear"),b.set(l(a))}}(),b},U=function(a){var b=T(a),d=a.ajax,e=a.url||a.$.attr("action"),f="",g={},h=function(){return f?B.set(e,v({action:f},g)):e};return b.setAction=function(a){f=a},b.setParameters=function(a){if(!c(a))throw"parameters must be an object";g=a},d(a.$,function(){return{url:h(),dataType:"json",data:b.get(),validate:function(){var a=b.validate(b.get());return i(a)?!0:(b.setFeedback(a),b.publish("error",{data:a,action:f}),!1)},onprogress:function(a){b.publish("onprogress",{data:a,action:f})},beforeSend:function(){b.disable(),b.publish("beforeSend",{action:f})},success:function(a){a=a||{},b.setGlobalSuccess(a.successMessage),b.publish("success",{data:a,action:f})},error:function(a){b.setFeedback(a),b.publish("error",{data:a,action:f})},complete:function(a){b.enable(),b.publish("complete",{data:a,action:f})}}}),b},V=function(a){var b=T(a),c=a.$,d=a.request,e=a.isInstantSearch,f=a.inputs,g=function(){d.setFilter(b.get()),d.setPage(1),d.search()};return c.submit(function(a){a.preventDefault(),g()}),e&&m(f,function(a){a.subscribe("change",g)}),b},W=function(a){var b={},c=a.$,d=a.request,e=a.orderIcons||{neutral:"&#8597;",ascending:"&#8593;",descending:"&#8595;"},f=function(){var a={};return c.find("[data-field]").each(function(){var b=$(this);a[b.data("field")]=function(){var a={},c=b.is("[data-order]")?b:b.find("[data-order]"),d=c.data("order")||"neutral";return a.set=function(a){c.data("order",a),c.html(e[a]),d=a},a.get=function(){return d},a.next=function(){var b=["ascending","descending"],c=b[(j(b,d)+1)%b.length];a.set(c)},a}()}),a}();return c.find("[data-field]").click(function(a){a.preventDefault();var b=$(this).data("field");s(x(f,[b]),"set",["neutral"]),f[b].next(),d.setOrder(r(s(f,"get"),function(a){return"neutral"===a?"":a})),d.setPage(1),d.search()}),b},X=function(a){var b=T(a),c=a.$;return c.submit(function(a){a.preventDefault(),b.publish("submit",b.get())}),b.show=function(){c.show()},b.hide=function(){c.hide()},b},Y=function(a){var b={},c=a.name,d=a.request,f=a.gotoPage,g=v({noPage:"Must enter a page number.",notAnInteger:"Must enter valid page number.",nonPositiveNumber:"Page number must be positive.",pageNumberOutOfBounds:"Page number cannot exceed the total number of pages."},a.errorMessages||{}),h=$(".frm-number-of-pages-"+c),j=$(".frm-number-of-results-"+c),k=$(".frm-page-numbers-"+c),l=($(".frm-goto-page-"+c),$(".frm-previous-"+c)),p=$(".frm-next-"+c),q=k.find(".frm-next-"+c),r=function(a){return a.is("data-number")?a:a.find("[data-number]")},t=e(r(k.find(".frm-number-container.selected")).data("number"))||1,w=e(h.html())||t,x=e(j.html())||null,y=function(){var a=$(k.find(".frm-number-container")[0]).clone();return a.removeClass("selected"),r(a).html("").data("number",""),a}(),z=function(a){a=e(a),a!==w&&(h.html(a),w=a)},A=function(a){a=e(a),a!==x&&(j.html(a),x=a)},B=function(){for(var a=n(t-3,t+3);a[0]<1;)a.shift(),a.push(o(a)+1);for(;!i(a)&&o(a)>w;)a.pop();for(;a.length<7&&a[0]>1;)a.unshift(a[0]-1);return a},C=function(a){t=a,d.setPage(a),d.search()},D=function(a){var b={},c=a.$,d=c.find("[data-number]"),f=a.pageNumber||e(d.data("number"));return b.set=function(a){a=e(a),f!==a&&(d.html(a),f=a)},b.get=function(){return f},b.setSelected=function(){c.addClass("selected")},b.clearSelected=function(){c.removeClass("selected")},b.destroy=function(){c.remove()},d.html(f),c.click(function(a){a.preventDefault(),C(f)}),b},E=function(){return E=[],k.find(".frm-number-container").each(function(){E.push(D({$:$(this)}))}),E}(),F=function(a){var b=u(E,function(b){return b.get()===a});return i(b)?null:b[0]},G=function(){s(E,"clearSelected");var a=F(t);a&&a.setSelected()},H=function(){var a=0;for(m(B(),function(b){if(E[a])E[a].set(b);else{var c=y.clone();q.length?c.insertBefore(q):k.append(c),E[a]=D({pageNumber:b,$:c})}a+=1});E[a];)E[a].destroy(),E.splice(a,1);G()};return b.show=function(){f&&f.show(),k.show(),l.show(),p.show()},b.hide=function(){f&&f.hide(),k.hide(),l.hide(),p.hide()},b.validate=function(a,b){var c={},d=e(a.page);return a.page?isNaN(d)?c.page=g.notAnInteger:0>=d?c.page=g.nonPositiveNumber:d>b&&(c.page=g.pageNumberOutOfBounds):c.page=g.noPage,c},d.subscribe("success",function(a){a=a||{};var b=a.data;(0===e(b.numberOfPages)||b.numberOfPages)&&z(b.numberOfPages),b.numberOfResults&&A(b.numberOfResults),H()}),d.subscribe("setPage",function(a){t=a}),f&&f.subscribe("submit",function(a){var c=b.validate(a,w);i(c)?(f.clearFeedback(),f.reset(),C(e(a.page))):f.setFeedback(c)}),l.click(function(a){a.preventDefault(),i(b.validate({page:t-1},w))&&C(t-1)}),p.click(function(a){a.preventDefault(),i(b.validate({page:t+1},w))&&C(t+1)}),b},Z=function(c){var d=A(),e=c.ajax,f=c.url,g={},h=function(){return B.set(f,u(g||{},function(a){return b(a)?a.length:a||0===a}))},i=function(a){g=v(g,a)};return d.setOrder=function(c){i(r(c,a,function(a){return"order_"+(b(a)?a.join(","):a)}))},d.setFilter=function(c){i(r(c,a,function(a){return"filter_"+(b(a)?a.join(","):a)}))},d.setPage=function(a){i({page:a}),d.publish("setPage",a)},d.search=function(){e({type:"GET",url:h(),dataType:"json",success:function(a){d.publish("success",{data:a,action:"get"})},error:function(a){d.publish("error",{data:a.responseJSON,action:"get"})},complete:function(a){d.publish("complete",{data:a.responseJSON,action:"get"})}})},d["delete"]=function(a){e({type:"POST",url:B.set(f,v(a.uniquelyIdentifyingFields,{action:"delete"})),dataType:"json",success:function(b){a.success(b),d.publish("success",{data:b,action:"delete"})},error:function(b){y(a.error,b.responseJSON),d.publish("error",{data:b.responseJSON,action:"delete"})},complete:function(b){y(a.complete,b.responseJSON),d.publish("complete",{data:b.responseJSON,action:"delete"})}})},d},_=function(c){var d=A(),e=c.$self,f=c.fieldMap||{},g=function(a){return b(a)?a.join(", "):a},h=function(a){m(a,function(a,b){e.find('[data-field="'+b+'"]').html(f[b]?f[b](a):g(a))})},i=function(){var a=function(a){return/^\[.*\]$/.test(a)?r(a.replace(/^\[/,"").replace(/\]$/,"").split(","),function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")}):a},b={};return e.find("[data-field]").each(function(){b[$(this).data("field")]=a($(this).data("value"))||""}),b},j=i();return h(j),d.get$=function(){return e},d.set=function(b){var c=r(b,a,function(a){return k(t(j),a+"[]")?a+"[]":a}),e=u(c,function(a,b){return"undefined"==typeof j[b]?!1:j[b]!==a});return j=v(j,e),h(e),d},d.hardSet=function(a){d.clear(),d.set(a)},d.clear=function(){return e.find("[data-field]").html(""),e.find("[data-value]").attr("data-value",""),j=r(j,function(){return""}),d},d.destroy=function(){e.remove()},d.get=function(){return l(j)},d.addSelectedClass=function(){e.addClass("selected")},d.removeSelectedClass=function(){e.removeClass("selected")},e.dblclick(function(){d.publish("selected",d)}),e.find(".frm-edit-item").click(function(){d.publish("selected",d)}),e.find(".frm-delete-item").click(function(){d.publish("delete",d)}),d},ab=function(a){var d=A(),e=a.$,f=a.fieldMap||{},g=a.deleteConfirmation,h=a.uniquelyIdentifyingFields,i=a.request,k=function(){var a=e.find(".frm-list-item:first-child").clone(),b=_({$self:a,fieldMap:f});return b.clear(),a}(),l=function(a){a.subscribe("selected",function(){d.setSelectedClass(a),d.publish("selected",a)});var b=function(){var b=w(a.get(),h);i["delete"]({uniquelyIdentifyingFields:b,success:function(){d.remove(a),d.publish("deleted",a)}})};return a.subscribe("delete",function(){if(g)g(b);else{var a=confirm("Are you sure you want to delete this item?");a&&b()}}),a},n=function(){var a=[];return e.find(".frm-list-item").each(function(){a.push(l(_({$self:$(this),fieldMap:f})))}),a}();return d.setSelectedClass=function(a){d.clearSelectedClass(),a.addSelectedClass()},d.clearSelectedClass=function(){s(n,"removeSelectedClass")},d.set=function(a){var b=[];m(a,function(a,c){var d;n[c]?n[c].hardSet(a):(d=k.clone(),b.push(d),n[c]=l(_({$self:d,fieldMap:f})),n[c].set(a))}),e.append(b),n.length>a.length&&s(n.splice(a.length,n.length-a.length),"destroy")},d.remove=function(a){-1!==j(n,a)&&n.splice(j(n,a),1),a.destroy()},d.prepend=function(a){var b=k.clone(),c=l(_({$self:b,fieldMap:f}));return c.set(a),n.unshift(c),e.prepend(b),c},i.subscribe("success",function(a){if("get"===a.action){a=a||{};var e=a.data;d.set(c(e)&&b(e.results)?e.results:[])}}),d},bb=function(a){var b=A(),c=a.$;return c.click(function(){b.publish("click")}),b},cb={};cb.init=function(a){var b={};a.validate=f(a.validate,b);var c=a.name,g=E(a),h=g.form(),i=g.newItemButton(),j=g.request(),k=g.list(j),l=(g.search(j),g.ordinator(j),g.paginator(j)),m=null,n=null,o=function(a){d(a)&&a.apply(b,Array.prototype.slice.call(arguments,1))},p=function(b,c){b&&b.subscribe(c,function(b){o(a[c],b.action,b.data)})};b.reset=function(){h&&(h.reset(),k&&h.setAction("create")),k&&k.clearSelectedClass(),n=null,m=null},b.clearFormFeedback=function(){h&&h.clearFeedback()},b.setFormParameters=function(a){h&&h.setParameters(a)},k&&h&&(h.setAction("create"),k.subscribe("selected",function(b){h.set(b.get()),h.setAction("update"),n=b,o(a.selected,b.get$())}),h.subscribe("beforeSend",function(){m=h.get()}),h.subscribe("success",function(a){a=a||{};var c=a.data||{};n&&m?n.set(m):m&&(n=k.prepend(v(m,c.fields||{})),k.setSelectedClass(n)),b.reset()}),i&&i.subscribe("click",function(){b.reset(),b.clearFormFeedback()}));var q=$(".frm-no-results-"+c);return k&&(k.subscribe("deleted",function(a){n===a&&b.reset()}),j.subscribe("success",function(a){a=a||{};var c=a.data?a.data.results||[]:[],d=a.data?e(a.data.numberOfPages):0;b.reset(),0!==c.length?q.hide():"get"===a.action&&q.show(),l&&(d>1?l.show():"get"===a.action&&l.hide())})),p(h,"onprogress"),p(h,"success"),p(h,"error"),p(h,"complete"),p(j,"success"),p(j,"error"),p(j,"complete"),b},window.forminator=cb}();